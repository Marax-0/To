from Crypto.Cipher import AES
from Crypto.Util.Padding import unpad
from urllib.parse import unquote
import base64

# 0. ฟังก์ชันเติม padding base64
def fix_base64(s):
    return s + '=' * (-len(s) % 4)

# 1. อ่าน iv.txt แบบไบนารี
with open("iv.txt", "rb") as f:
    iv = f.read()

# 2. ใส่ key ที่ได้จาก strings.xml
key = b"yTzuj7LBNv9nDA4aWig3qCeLHYLJCTLt"  # ต้องเป็น bytes

# 3. ใส่ ciphertext ที่แกะจาก strings.xml
ciphertext_b64 = "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"

# 4. แก้ padding และ decode
ciphertext_fixed = fix_base64(ciphertext_b64)
cipher_bytes = base64.b64decode(ciphertext_fixed)

# 5. ถอดรหัส
cipher = AES.new(key, AES.MODE_CBC, iv)
decrypted = cipher.decrypt(cipher_bytes)
unpadded = unpad(decrypted, AES.block_size)
plaintext = unquote(unpadded.decode('utf-8'))

print("✅ ถอดรหัสได้:", plaintext)


ISAG{rMacenEsTntNUr}
